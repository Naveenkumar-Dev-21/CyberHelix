# Autonomous Pentesting System

## Complete AI-Driven Security Testing Without Human Intervention

This project has been enhanced with a **fully autonomous pentesting system** that can operate without human interaction, continuously learning and self-healing to provide comprehensive security assessments.

## 🤖 Key Features

### Autonomous Operation
- **Zero Human Intervention**: Operates completely autonomously once started
- **Intelligent Decision Making**: AI-powered decisions on which tests to run and when
- **Dynamic Task Generation**: Automatically generates new tasks based on findings
- **Risk-Based Prioritization**: Focuses on high-risk targets and vulnerabilities first

### Continuous Learning
- **Machine Learning Integration**: Learns from every scan and improves over time
- **Knowledge Base**: Builds profiles of targets and remembers successful techniques
- **Pattern Recognition**: Detects vulnerability patterns and attack success patterns
- **Performance Optimization**: Continuously optimizes scanning parameters

### Self-Healing & Recovery
- **Automatic Error Recovery**: Recovers from failures without human intervention
- **System Health Monitoring**: Monitors CPU, memory, disk, and network health
- **Failure Classification**: Intelligently classifies and handles different failure types
- **Alternative Tool Selection**: Automatically switches tools when primary tools fail

### Advanced AI Components
- **Multi-Model Analysis**: Uses multiple specialized AI models for different target types
- **Vulnerability Prediction**: Predicts vulnerabilities before traditional scans
- **Attack Vector Recommendations**: AI-recommended attack vectors based on target analysis
- **Execution Planning**: Automatically generates optimal scan execution plans

## 🚀 Getting Started

### Prerequisites

1. **Install Dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

2. **Install Additional ML Dependencies** (for enhanced learning):
   ```bash
   pip install spacy
   python -m spacy download en_core_web_sm
   ```

3. **Configure API Keys** (copy `.env.example` to `.env`):
   ```bash
   cp .env.example .env
   # Edit .env with your API keys
   ```

4. **Install Pentesting Tools** (optional but recommended):
   ```bash
   # Core tools
   sudo apt install nmap nuclei nikto sqlmap
   
   # Additional tools
   sudo apt install amass theharvester wafw00f
   ```

### Quick Start - Autonomous Mode

Run autonomous pentesting on targets with full AI capabilities:

```bash
# Basic autonomous scan
python -m src.main autonomous example.com

# Advanced autonomous scan with all features
python -m src.main autonomous \
    --max-duration 7200 \
    --learning \
    --self-healing \
    --escalation \
    --max-targets 5 \
    --verbose \
    example.com target2.com

# Continuous autonomous mode (runs indefinitely)
python -m src.main autonomous \
    --continuous \
    --max-duration 3600 \
    --webhook https://your-webhook.com/notify \
    example.com
```

## 📋 Command Reference

### Autonomous Commands

#### `autonomous` - Full Autonomous Operation
Run completely autonomous pentesting with AI decision-making:

```bash
python -m src.main autonomous [OPTIONS] TARGETS...

Options:
  --max-duration INTEGER        Maximum session duration in seconds (default: 14400)
  --continuous                  Enable continuous mode
  --learning / --no-learning    Enable/disable learning system (default: enabled)
  --self-healing / --no-self-healing  Enable/disable self-healing (default: enabled)
  --escalation / --no-escalation      Enable/disable privilege escalation
  --max-targets INTEGER         Maximum targets per session (default: 10)
  --webhook TEXT               Notification webhook URL
  --verbose                    Verbose output

Examples:
  # Single target with learning
  python -m src.main autonomous --learning example.com
  
  # Multiple targets with healing
  python -m src.main autonomous --self-healing target1.com target2.com
  
  # Long-running session with notifications
  python -m src.main autonomous --max-duration 28800 --webhook https://hooks.slack.com/... example.com
```

#### `learning` - Manage Learning System
Control the continuous learning system:

```bash
python -m src.main learning [OPTIONS]

Options:
  --status                      Show learning system status
  --stats                       Show detailed learning statistics
  --backup                     Backup knowledge base
  --reset                      Reset all learning data (dangerous!)
  --target TEXT               Get recommendations for a specific target

Examples:
  # Check learning system status
  python -m src.main learning --status
  
  # Get AI recommendations for a target
  python -m src.main learning --target example.com
  
  # Backup the knowledge base
  python -m src.main learning --backup
```

#### `healing` - Manage Self-Healing System
Control the self-healing and recovery system:

```bash
python -m src.main healing [OPTIONS]

Options:
  --status                      Show self-healing system status
  --enable                     Enable self-healing
  --disable                    Disable self-healing
  --diagnostics                Export diagnostics data
  --test TEXT                  Test failure handling for specific failure type

Examples:
  # Check healing system status
  python -m src.main healing --status
  
  # Test network failure recovery
  python -m src.main healing --test network
  
  # Export diagnostics
  python -m src.main healing --diagnostics
```

## 🧠 How It Works

### 1. Autonomous Agent Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                 Autonomous Orchestrator                     │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
│  │   Pentest   │  │  Learning   │  │Self-Healing │         │
│  │    Agent    │  │   System    │  │   System    │         │
│  └─────────────┘  └─────────────┘  └─────────────┘         │
├─────────────────────────────────────────────────────────────┤
│           Decision Engine + Risk Assessment                 │
├─────────────────────────────────────────────────────────────┤
│  Recon │ Vuln Scan │ Service │ Web │ Mobile │ Wireless │  │
├─────────────────────────────────────────────────────────────┤
│              Traditional Pentesting Tools                   │
└─────────────────────────────────────────────────────────────┘
```

### 2. Decision-Making Process

The autonomous agent makes decisions based on:
- **Risk Scores**: Calculated from target analysis and vulnerability data
- **Historical Success Rates**: Learned from previous scans
- **Resource Availability**: CPU, memory, disk, network status
- **Time Constraints**: Remaining session time and task priorities

### 3. Learning Process

The system continuously learns from:
- **Task Execution Results**: Success/failure rates, execution times
- **Vulnerability Patterns**: Common vulnerability combinations
- **Target Characteristics**: Service fingerprints, technology stacks
- **Attack Success Patterns**: Which techniques work on similar targets

### 4. Self-Healing Capabilities

The system can recover from:
- **Network Errors**: Retry with backoff, switch endpoints
- **Tool Failures**: Switch to alternative tools automatically
- **Permission Errors**: Attempt privilege escalation or fallback methods
- **Timeout Errors**: Adjust parameters and retry
- **Resource Exhaustion**: Clean caches, reduce load, emergency cleanup

## 📊 Monitoring and Reports

### Real-Time Status
Check autonomous system status:
```bash
# Get comprehensive system status
python -c "
from src.autonomous_workflow import AutonomousOrchestrator
from src.continuous_learning_system import ContinuousLearningSystem  
from src.self_healing_system import SelfHealingSystem

# Show status of all systems
orchestrator = AutonomousOrchestrator()
print('Orchestrator Status:', orchestrator.get_system_status())

learning = ContinuousLearningSystem()
print('Learning Stats:', learning.get_learning_stats())

healing = SelfHealingSystem()
print('Healing Status:', healing.get_system_status())
"
```

### Generated Reports

The autonomous system generates multiple report types:

1. **Session Summary** (`autonomous_summary_*.txt`): Human-readable summary
2. **Detailed Report** (`autonomous_report_*.json`): Complete session data
3. **Learning Analytics** (`learning_kb_*.db`): Knowledge base backups
4. **Health Diagnostics** (`self_healing_diagnostics_*.json`): System health data

## ⚙️ Configuration

### Autonomous Configuration Options

```python
# Example configuration for autonomous operations
config = {
    'max_session_duration': 14400,     # 4 hours
    'continuous_mode': False,          # Set True for continuous operation
    'learning_enabled': True,          # Enable continuous learning
    'self_healing_enabled': True,      # Enable self-healing
    'escalation_enabled': False,       # Enable privilege escalation
    'max_targets_per_session': 10,     # Maximum targets per session
    'notification_webhook': None,      # Webhook for notifications
    'backup_interval': 3600,           # Backup interval in seconds
    'auto_restart': True,              # Auto-restart on completion
    'report_generation': True,         # Generate reports
    'resource_monitoring': True        # Monitor system resources
}
```

### Learning System Configuration

The learning system automatically configures itself but can be customized:

```python
# Learning system parameters
learning_config = {
    'pattern_detection_interval': timedelta(hours=6),
    'min_samples_for_learning': 5,
    'learning_rate': 0.1
}
```

## 🔧 Advanced Usage

### Programmatic Usage

```python
import asyncio
from src.autonomous_workflow import run_autonomous_pentest

async def run_autonomous_scan():
    config = {
        'max_session_duration': 7200,  # 2 hours
        'learning_enabled': True,
        'self_healing_enabled': True,
        'escalation_enabled': False
    }
    
    targets = ['example.com', 'target2.com']
    session_id = await run_autonomous_pentest(targets, config)
    print(f"Autonomous scan completed: {session_id}")

# Run the autonomous scan
asyncio.run(run_autonomous_scan())
```

### Continuous Mode with Custom Target Sources

```python
import asyncio
from src.autonomous_workflow import run_continuous_autonomous_pentest

def get_targets_from_database():
    """Example: Get targets from a database"""
    return ['new-target.com', 'another-target.com']

def get_targets_from_api():
    """Example: Get targets from an API"""
    return ['api-discovered-target.com']

async def run_continuous():
    target_sources = [
        get_targets_from_database,
        get_targets_from_api
    ]
    
    config = {
        'continuous_mode': True,
        'max_session_duration': 3600,  # 1 hour per session
        'learning_enabled': True,
        'self_healing_enabled': True
    }
    
    await run_continuous_autonomous_pentest(
        target_sources=target_sources,
        config=config,
        check_interval=1800  # Check every 30 minutes
    )

# Run continuous mode
asyncio.run(run_continuous())
```

## 🛡️ Security Considerations

### Authorization and Ethics
- **Always obtain proper authorization** before running autonomous scans
- **Set appropriate target constraints** to avoid scanning unauthorized systems
- **Monitor scan activity** and be prepared to stop if needed
- **Comply with local laws** and regulations regarding security testing

### Safe Configuration
```bash
# Safe autonomous configuration
python -m src.main autonomous \
    --max-duration 1800 \      # 30 minutes max
    --no-escalation \          # No privilege escalation
    --max-targets 1 \          # Single target only
    --verbose \                # Full logging
    authorized-target.com
```

### Resource Limits
The autonomous system includes built-in resource monitoring:
- CPU usage limits (85% threshold)
- Memory usage limits (80% threshold)
- Disk space monitoring (90% threshold)
- Network latency monitoring
- Automatic cleanup when thresholds are exceeded

## 🚨 Troubleshooting

### Common Issues

1. **Learning System Not Working**:
   ```bash
   # Check learning system status
   python -m src.main learning --status
   
   # Reset learning data if corrupted
   python -m src.main learning --reset
   ```

2. **Self-Healing System Errors**:
   ```bash
   # Check healing system status
   python -m src.main healing --status
   
   # Export diagnostics for analysis
   python -m src.main healing --diagnostics
   ```

3. **High Resource Usage**:
   ```bash
   # Check system health
   python -m src.main healing --status
   
   # The system will automatically handle resource issues
   # but you can manually trigger cleanup if needed
   ```

4. **Autonomous Session Stuck**:
   - The system includes automatic timeout handling
   - Use Ctrl+C to gracefully stop the session
   - Check logs in the `reports/` directory for details

### Debug Mode

Run with verbose logging for troubleshooting:
```bash
python -m src.main autonomous --verbose --max-duration 300 target.com
```

## 📈 Performance Optimization

### Learning Optimization
- The system learns optimal scan parameters over time
- Success rates improve with more scan data
- Target profiling becomes more accurate with usage

### Resource Optimization
- Automatic resource cleanup when limits are reached
- Adaptive scan parameters based on system performance
- Emergency cleanup procedures for critical resource situations

### Scan Optimization
- Dynamic tool selection based on target characteristics
- Intelligent timeout adjustments based on historical data
- Priority-based task scheduling for maximum efficiency

## 🔮 Future Enhancements

The autonomous system is designed for continuous improvement:

- **Enhanced AI Models**: More sophisticated vulnerability prediction
- **Advanced Attack Simulation**: Automated exploit chaining
- **Cloud Integration**: Multi-region scanning capabilities  
- **Threat Intelligence**: Integration with threat intel feeds
- **Collaborative Learning**: Shared learning across instances

## 📝 License and Disclaimer

This tool is for authorized security testing only. Users are responsible for ensuring they have proper authorization before scanning any targets. The autonomous capabilities are powerful and should be used responsibly.

---

**Note**: The autonomous system represents a significant advancement in automated security testing. Always use it responsibly and in accordance with applicable laws and ethical guidelines.
